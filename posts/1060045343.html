<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"><title>015 | Halo的开发者Bungie：与微软的聚散 | geekbang</title><meta name="author" content="码农张三"><meta name="copyright" content="码农张三"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="015 | Halo的开发者Bungie：与微软的聚散我会在这一年中介绍一些总部在西雅图，或者研发中心里面很重要的一部分在西雅图的IT公司。这其中除了微软和亚马逊这样的大鳄以外，还囊括了诸多在不同领域取得一定统治地位的公司们。 今天的主角是Bungie，一家总部位于西雅图地区贝尔维尤市的游戏公司，如今全球最大的游戏工作室之一。 Bungie工作室在国内玩家中知名度不高，但是其开发的游戏大作《光环》">
<meta property="og:type" content="article">
<meta property="og:title" content="015 | Halo的开发者Bungie：与微软的聚散">
<meta property="og:url" content="https://zhuansun.github.io/geekbang/posts/1060045343.html">
<meta property="og:site_name" content="geekbang">
<meta property="og:description" content="015 | Halo的开发者Bungie：与微软的聚散我会在这一年中介绍一些总部在西雅图，或者研发中心里面很重要的一部分在西雅图的IT公司。这其中除了微软和亚马逊这样的大鳄以外，还囊括了诸多在不同领域取得一定统治地位的公司们。 今天的主角是Bungie，一家总部位于西雅图地区贝尔维尤市的游戏公司，如今全球最大的游戏工作室之一。 Bungie工作室在国内玩家中知名度不高，但是其开发的游戏大作《光环》">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://s2.loli.net/2023/10/21/vq13okXnTbxDG2R.jpg">
<meta property="article:published_time" content="2023-10-20T09:48:40.000Z">
<meta property="article:modified_time" content="2023-12-13T15:14:51.213Z">
<meta property="article:author" content="码农张三">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://s2.loli.net/2023/10/21/vq13okXnTbxDG2R.jpg"><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="https://zhuansun.github.io/geekbang/posts/1060045343"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: {"path":"/search.json","preload":true,"languages":{"hits_empty":"找不到您查询的内容：${query}"}},
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"prismjs","highlightCopy":true,"highlightLang":false,"highlightHeightLimit":false},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  date_suffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: {"chs_to_cht":"你已切换为繁体","cht_to_chs":"你已切换为简体","day_to_night":"你已切换为深色模式","night_to_day":"你已切换为浅色模式","bgLight":"#49b1f5","bgDark":"#1f1f1f","position":"top-center"},
  source: {
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isAnchor: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: '015 | Halo的开发者Bungie：与微软的聚散',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2023-12-13 15:14:51'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const detectApple = () => {
      if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    })(window)</script><meta name="generator" content="Hexo 6.3.0"><link rel="alternate" href="/atom.xml" title="geekbang" type="application/atom+xml">
</head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="https://pic.imgdb.cn/item/653470a0c458853aef5813f1.png" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">804</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">0</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">12</div></a></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('https://s2.loli.net/2023/10/21/vq13okXnTbxDG2R.jpg')"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">geekbang</a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> 搜索</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div></div><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">015 | Halo的开发者Bungie：与微软的聚散</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="fa-fw post-meta-icon far fa-calendar-alt"></i><span class="post-meta-label">发表于</span><time datetime="2023-10-20T09:48:40.000Z" title="发表于 2023-10-20 09:48:40">2023-10-20</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E6%8A%80%E6%9C%AF%E4%B8%8E%E5%95%86%E4%B8%9A%E6%A1%88%E4%BE%8B%E8%A7%A3%E8%AF%BB/">技术与商业案例解读</a></span></div><div class="meta-secondline"></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><h1 id="015-Halo的开发者Bungie：与微软的聚散"><a href="#015-Halo的开发者Bungie：与微软的聚散" class="headerlink" title="015 | Halo的开发者Bungie：与微软的聚散"></a>015 | Halo的开发者Bungie：与微软的聚散</h1><p>我会在这一年中介绍一些总部在西雅图，或者研发中心里面很重要的一部分在西雅图的IT公司。这其中除了微软和亚马逊这样的大鳄以外，还囊括了诸多在不同领域取得一定统治地位的公司们。</p>
<p>今天的主角是Bungie，一家总部位于西雅图地区贝尔维尤市的游戏公司，如今全球最大的游戏工作室之一。</p>
<p>Bungie工作室在国内玩家中知名度不高，但是其开发的游戏大作《光环》（Halo）系列估计就有很多人熟悉了，这款游戏在Xbox上首发，并占据了极其重要的游戏地位。可以说，正是这款游戏让Xbox的主机上终于有了一款在当时可以和索尼PlayStation 2竞争的扛鼎之作，从此以后Xbox从可有可无的游戏平台走向了辉煌的主机巨头行列。而Bungie与其游戏的发行方或者说公司的收购方微软的合合分分，也是Xbox发展史上浓墨重彩的一笔。</p>
<p>Bungie最初是一个人的传奇故事。1991年，在芝加哥大学就读的亚历克斯 · 瑟罗皮恩（Alex Seropian）创办了自己的游戏公司。其实在创办游戏公司之前，他就已经自己开发仿制了当时非常流行的一款乒乓球类街机游戏，奠定了自己的游戏开发之旅。</p>
<p>Bungie成立的1991年，计算机还是个新事物，美国的大部分大学还没有日后大红大紫的计算机科学系，而计算机专业则依托于数学或者电子系下面。所以那个时候做软件开发，尤其是游戏开发，想要获得投资更是非常不易。</p>
<p>瑟罗皮恩在亲朋好友的帮助下，自己组装硬件开发软件，在游戏开发的道路上越走越远。不过，他并没有赚到多少钱。据说是在上一门人工智能课程时，瑟罗皮恩遇到了Bungie的第二名员工杰森 · 琼斯（Jason Jones）。</p>
<p>琼斯也是游戏的狂热爱好者。他完成了一款叫作Minotaur的角色扮演游戏，这款游戏还运用了AppleTalk这种互联网联网协议，使不同的用户可以通过“猫”实现互联。这款以Buggie公司名义发布的游戏尽管本身销量在当时并不可观，但作为Buggie创立以来的第一桶金，为这两位游戏的狂热爱好者开发下一款游戏提供了资金支持。</p>
<p>当时射击游戏很流行，因此瑟罗皮恩和琼斯的下一款游戏，也转向了射击类，这就是在Bungie历史上第一款广受赞誉的《黑暗之路》（Pathways into Darkness）。这款游戏的开发在很大程度上奠定了Bungie此后多年的游戏开发模式：专注于射击游戏的开发，让其他人越来越难超越。</p>
<p>射击游戏并不罕见，比如《毁灭战士》（DOOM）当时就很火。然而这些游戏的普遍特点就是为了射击而射击，缺乏故事情节作支撑，让人很难感受到游戏的乐趣。Bungie在这个时候推出了整个游戏历史上都要浓墨重彩记上一笔的《马拉松》（Marathon）系列的首款游戏。</p>
<p>和以往的射击游戏比起来，《马拉松》的情节曲折连贯，引人入胜。而那个早在其他游戏里就尝试采用过的AppleTalk，也成为了这款游戏最为独特的一部分，《马拉松》成了第一款可以在不同玩家之间联网和交互的射击游戏。这都让Bungie在众多游戏公司中迅速脱颖而出。</p>
<p>Bungie的《马拉松》迅速占领了市场。毕竟，能够联网的射击游戏和不能够联网的射击游戏不可同日而语。</p>
<p>因为一望无际的好日子，Bungie的境况，尤其是财务状况蒸蒸日上，并且很快推出了《马拉松》的续集。</p>
<p>此时恰逢Windows 95降临的大潮，头脑活络的Bungie把《马拉松》续集移植到了Windows上。而Windows市场的销量远远大于Mac市场，这一波移植的成功让Bungie顿悟了“Windows才是未来”。</p>
<p>《马拉松》系列的新版本就在Windows和Mac上同步发行了。这几款《马拉松》游戏让Bungie在射击游戏领域一时声名鹊起，并且有了源源不断的订单和滚滚金钱。</p>
<p>好日子仍然在延续，而聪明的Bungie意识到应该新起一个系列了，毕竟单靠啃《马拉松》系列的“老本”过活，并不是公司长远发展的明智之举。</p>
<p>新游戏《神话》（Myth）应运而生，这是一款策略游戏，虽然很遗憾我没玩过，但从游戏玩家论坛中仍然可以看到，这款游戏当初是多么受欢迎。</p>
<p>《马拉松》和《神话》大获成功，让Bungie一跃成为世界顶级的游戏工作室和发行厂商。这时，Bungie再次回到了他们所擅长的射击游戏上来，新的一款游戏被命名为《光环》（Halo）。这款游戏在未来的几年让Bungie获得了大量声誉，但同时也带来了很多麻烦。</p>
<p>《光环》游戏最初于1999年宣布，同年苹果公司CEO史蒂夫 · 乔布斯在Macworld Expo的Keynote上公开做了演示。这也是Bungie在苹果公司那边获得的最高规格待遇。</p>
<p>但是Bungie显然已经从Windows和Mac同步发行上尝到了很多好处，《光环》最初的计划也是在Windows和Mac上同步发行，这种“一鱼两吃”的做法，Bungie已经驾轻就熟。</p>
<p>2000年6月，Bungie在E3 2000上公开展示了《光环》，获得了极大的好评。然而，正当大家都在翘首期盼《光环》正式发行的时候，出乎所有人意料，微软宣布Bungie被他们收购了，Bungie已经成为微软游戏分支的子企业。不久以后，微软决定，《光环》系列不在Windows和Mac中的任意一个平台发行，其唯一发行平台是微软的新游戏主机Xbox。</p>
<p>有关这场收购背后的故事有很多版本。但目前来看，比较靠谱的说法是《神话2》有一个巨大的Bug，可以删除用户硬盘上的所有资料。所以Bungie被迫在发行前进行召回，但这样一来就损失了几百万美元，让Bungie陷入了财务危机。</p>
<p>而此时的微软正需要为它的新业务Xbox主机的发展寻找一款很好的游戏大作。相对于索尼这个历史悠久的主机PlayStation 2上大作频出的局面，微软的Xbox当时要么是索尼的移植版，要么就是不值一提的作品，因此急需一款属于并且只属于Xbox的大作。</p>
<p>这样一来，陷入财务危机的Bungie和需要大作的微软一拍即合，微软买下了Bungie，同时让《光环》成为了Xbox的专属游戏。然而，收购价据说仅为5000万美元。</p>
<p>实际上，早在推出《神话》系列的同时，Bungie还成立了分支机构Bungie West。这个新成立的分支机构发行了一款叫作《奥尼》（Oni）的游戏。这款游戏算不上大红大紫，加上游戏发行的时候Bungie被微软收购了，因此最终没能够形成一个系列。</p>
<p>而作为并购的一部分，微软同时也获得了《神话》系列和《奥尼》一半的版权。《奥尼》的开发在2001年结束以后，就没再有续作了。整个Bungie工作室的重心从此转到了给Xbox开发《光环》系列上。这个转型，也为以后Bungie和微软之间的分道扬镳埋下了伏笔。</p>
<p>《光环》系列的首作取得了极其巨大的成功，发行量超过650万份，市场反应热烈，这是Bungie从未达到过的高度。当时，微软的高层比尔 · 盖茨和鲍尔默都忍不住要让Bungie尽快开发《光环2》。</p>
<p>这里插一句，考虑到这款游戏只在Xbox上发行，倘若它能在更多平台发行的话，数字可能更是无法想象。</p>
<p>我来西雅图以后正好认识了《光环》游戏系列的一位开发者，在某次听他讲述这段工作经历时才得知，《光环2》是整个系列里面开发最为辛苦的一版游戏：因为微软高层都对《光环2》的开发抱有很高的期望，而《光环1》又给游戏开发设置了一个很高的标准，这让《光环2》的开发一直不顺，期间多次推倒重来。好在最后《光环2》不负众望地上市了，并且因为和Xbox Live的对接获得了更大的成功。</p>
<p>Xbox Live是微软为Xbox主机创建的一个可以让全球各地的人联网战斗的平台。这个平台和以往联网游戏最大的不同是：以往的游戏往往都是在局域网内自行组团，而Xbox Live则提供了一个全球统一的平台，并且可以记录每个人自己的战绩和游戏历史，还具有一定的社交功能。</p>
<p>Xbox Live和《光环2》的对接，使得世界各地的《光环》爱好者们都可以在统一的平台上联网战斗，分享游戏体验，还可以看到排名等各种统计数据。因此，世界各地的游戏爱好者蜂拥而至，非常踊跃地参与进来。</p>
<p>《光环2》达到了一个新的高度。《光环》系列从此不再只是一款简单的射击游戏，还是一个社交平台。全世界的《光环》玩家都可以共享游戏体验。因为《光环2》的发行，Xbox的销量也迅猛增长。游戏带动主机的销售，这就是微软一直期盼的大作效应。</p>
<p>2007年发行的《光环3》让这款游戏更上一层楼。为此，Bungie还给《光环》系列发行了两个资料片。</p>
<p>但是《光环3》发行没多久，Bungie就和微软同时宣布拆分，Bungie脱离微软成为一家独立的公司，而《光环》系列的所有知识产权归属于微软。作为拆分计划的一部分，微软于同年成立了343工作室，替代Bungie制作和发行《光环》系列。《光环4》和《光环5》都是由这个工作室制作的。</p>
<p>若说当初的收购还有迹可循，这次拆分的缘由就一直不太明朗了。一直到十年后的今天，也没有多少资料公开谈论这次拆分。Bungie和微软的合作延续到了2010年，《光环3》第二部资料片的发布。</p>
<p>我和那个开发《光环》的工程师聊天时，感觉到在被微软收购的那几年里，公司的一切事务都围绕着《光环》系列进行，这让整个工作室都有点茫然失措。按道理，微软的收购很大程度上给Bungie提供了丰富的资源，这才使得《光环》系列获得了如此巨大的成功。</p>
<p>但是与此同时，Bungie丧失了自主权和独立性。Bungie存在的作用，对于微软来说就是开发《光环》系列。在被微软收购后的那些日子里，除去《光环》系列，Bungie竟然没有能够开发出任何一款新游戏。这对于Bungie的游戏开发者来说，肯定不是多么愉悦的事情。</p>
<p>更重要的是，游戏工作室讲究独立性，微软本身则越来越官僚，两者之间难免会在文化上有很多冲突，这种冲突可能可以控制在比较好的范围内，也可能会导致很多的问题。</p>
<p>我想到了后期，Bungie自己想做的事情，和微软需要它们做的事情，两者之间不仅仅没法沟通和妥协，很可能微软连听都懒得听Bungie的想法了吧。2007年的微软，是官僚主义很盛行的时候。</p>
<p>坊间另外一个传闻是5000万的价格收购Bungie，微软多少有些趁Bungie财务危机之虚而进入的嫌疑。这笔钱从今天来看，显然是便宜了。而连续不断地让Bungie只为Xbox开发《光环》系列，可能更是让Bungie觉得在微软下面毫无发展空间可言，并最终走上拆分之路。</p>
<p>拆分以后的Bungie继续扩张，并把新的总部设置在了贝尔维尤市中心。然后，它与全球知名的游戏制作和发行厂商动视暴雪展开合作，由后者替其出版发行下一款游戏大作《命运》。Bungie新发行的游戏《命运》是其独立以后的第一个游戏系列，但是无论人气还是名气，都远远未能达到《光环》系列的标准。</p>
<p>可以确定的是，离开微软之后Bungie未来的路会更加艰难。拆分十年过去了，现在的《命运》系列依旧无法和《光环》系列相比。它始终没能够像《光环》系列那样万众瞩目，受到玩家的极力追捧，在销量上也未能和《光环》系列媲美。</p>
<p>想必今天的故事，难免会让你一番感慨。亲爱的读者，如果你是Bungie的创始人，在2000年的时候会不会接受微软的收购？在2007年的时候又会不会选择离开微软？</p>
</article><div class="tag_share"><div class="post_share"></div></div></div><div class="aside-content" id="aside-content"><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#015-Halo%E7%9A%84%E5%BC%80%E5%8F%91%E8%80%85Bungie%EF%BC%9A%E4%B8%8E%E5%BE%AE%E8%BD%AF%E7%9A%84%E8%81%9A%E6%95%A3"><span class="toc-number">1.</span> <span class="toc-text">015 | Halo的开发者Bungie：与微软的聚散</span></a></li></ol></div></div></div></div></main><footer id="footer" style="background-image: url('https://s2.loli.net/2023/10/21/vq13okXnTbxDG2R.jpg')"><div id="footer-wrap"><div class="copyright">&copy;2022 - 2023 By 码农张三</div></div><script src="https://cdn.bootcdn.net/ajax/libs/mermaid/9.4.0/mermaid.min.js"></script></footer></div><div id="rightside"><div id="rightside-config-hide"></div><div id="rightside-config-show"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="回到顶部"><i class="fas fa-arrow-up"></i></button></div></div><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">搜索</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="is-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span>  数据库加载中</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"/></div></div><hr/><div id="local-search-results"></div></div></div><div id="search-mask"></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.umd.min.js"></script><script src="https://cdn.jsdelivr.net/npm/instant.page/instantpage.min.js" type="module"></script><script src="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.js"></script><script>function panguFn () {
  if (typeof pangu === 'object') pangu.autoSpacingPage()
  else {
    getScript('https://cdn.jsdelivr.net/npm/pangu/dist/browser/pangu.min.js')
      .then(() => {
        pangu.autoSpacingPage()
      })
  }
}

function panguInit () {
  if (false){
    GLOBAL_CONFIG_SITE.isPost && panguFn()
  } else {
    panguFn()
  }
}

document.addEventListener('DOMContentLoaded', panguInit)</script><script src="/js/search/local-search.js"></script><div class="js-pjax"><script>(() => {
  const $mermaidWrap = document.querySelectorAll('#article-container .mermaid-wrap')
  if ($mermaidWrap.length) {
    window.runMermaid = () => {
      window.loadMermaid = true
      const theme = document.documentElement.getAttribute('data-theme') === 'dark' ? 'dark' : 'default'

      Array.from($mermaidWrap).forEach((item, index) => {
        const mermaidSrc = item.firstElementChild
        const mermaidThemeConfig = '%%{init:{ \'theme\':\'' + theme + '\'}}%%\n'
        const mermaidID = 'mermaid-' + index
        const mermaidDefinition = mermaidThemeConfig + mermaidSrc.textContent
        mermaid.mermaidAPI.render(mermaidID, mermaidDefinition, (svgCode) => {
          mermaidSrc.insertAdjacentHTML('afterend', svgCode)
        })
      })
    }

    const loadMermaid = () => {
      window.loadMermaid ? runMermaid() : getScript('https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js').then(runMermaid)
    }

    window.pjax ? loadMermaid() : document.addEventListener('DOMContentLoaded', loadMermaid)
  }
})()</script></div></div></body></html>